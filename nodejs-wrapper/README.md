# dash-licenses-github-integration

npm package that makes it easier to integrate dash-licenses to Eclipse Foundation JavaScript/TypeScript projects on GitHub.

## How to use

This npm package contains a `check_3pp_licenses.js` script that serves as frontend to `dash-licenses`, an example GitHub workflow that uses it and sample "scripts" entries, that one can add to their project's `package.json` to call the script.

## Runtime requirements

- relatively recent node.js
- JDK or JRE: to run `dash-licenses`
- An Eclipse Foundation Gitlab token, generated by an Eclipse project committer, is necessary to run the script using the "automatic review mode". See `dash-licenses` [README](https://github.com/eclipse/dash-licenses#readme) for more details.
- To run the bundled GitHub workflow, the Gitlab token needs to be set as a GitHub Secret, named `DASH_TOKEN`.

## configuration file

A configuration file can be used to override defaults.

`dashLicensesConfig.json`:

```json
{
    "project": "ecd.theia",
    "review": true,
    "inputFile": "./package-lock.json",
    "batch": "50",
    "timeout": "240",
    "exclusionsFile": "./dashLicensesExclusions.json",
    "summaryFile": "summary.txt"
}
```

Exclusion file: `<repo_root>/dependency-check-baseline.json`

This file permits to exclude some of the dependencies from consideration. This can be useful for example with dependencies that were approved as "works-with", that `dash-licenses` can't yet handle, or dependencies that are under review but believed to have an acceptable license.

contains one dependency per line, with an optional comment. that can be used to track the justification for excluding the dependency from failing the license check.

For illustration purpose, here's the Eclipse Theia exclusion file, at the time of writing:

```json
{
  "npm/npmjs/-/allure-commandline/2.23.0": "Approved https://gitlab.eclipse.org/eclipsefdn/emo-team/iplab/-/issues/9379",
  "npm/npmjs/-/clone/2.1.2": "Under review, license believed to be MIT: https://gitlab.eclipse.org/eclipsefdn/emo-team/iplab/-/issues/7971",
  "npm/npmjs/-/eslint-plugin-deprecation/1.2.1": "Approved as 'works-with': https://dev.eclipse.org/ipzilla/show_bug.cgi?id=22573",
  "npm/npmjs/-/jschardet/2.3.0": "Approved for Eclipse Theia: https://dev.eclipse.org/ipzilla/show_bug.cgi?id=22481",
  "npm/npmjs/-/jsdom/11.12.0": "Approved as 'works-with': https://dev.eclipse.org/ipzilla/show_bug.cgi?id=23640https://dev.eclipse.org/ipzilla/show_bug.cgi?id=23640",
  "npm/npmjs/-/lzma-native/8.0.6": "Approved as 'works-with': https://gitlab.eclipse.org/eclipsefdn/emo-team/iplab/-/issues/1850",
  "npm/npmjs/-/playwright-core/1.22.2": "Approved as 'works-with': https://gitlab.eclipse.org/eclipsefdn/emo-team/iplab/-/issues/2734",
  "npm/npmjs/@octokit/openapi-types/12.11.0": "Under review: https://gitlab.eclipse.org/eclipsefdn/emo-team/iplab/-/issues/7693",
  "npm/npmjs/@octokit/openapi-types/16.0.0": "Under review: https://gitlab.eclipse.org/eclipsefdn/emo-team/iplab/-/issues/7694"
}

```

## Acknowledgements

This work is based on work contributed to the [Eclipse Theia main git repository](https://github.com/eclipse-theia/theia), by Ericsson and others.
